**分析绷膜料盘真实剥离段**

前提

从打印件打印日志分析[日志文件：backend_220120_132922.log](E:/文档/GitHub/Notiz/backend_220120_132922.log)

```c++
[2022-01-20][13:40:26.269][DEBUG] begin SyncPeel #开始准备剥离
[2022-01-20][13:40:26.269][TRACE] OnEnviromentCheck 56 data: QMap(("Projector", QVariant(bool, true))("Screen", QVariant(bool, true)))
[2022-01-20][13:40:26.270][DEBUG] [ "LCD-925-寄存牙模-100-2.ult" ] step: PrintCtrl::Peeling
[2022-01-20][13:40:26.270][INFO] led off
[2022-01-20][13:40:26.275][TRACE] command: "ac100118ff00000400000001d227acdc"
[2022-01-20][13:40:26.282][INFO] Peeling
[2022-01-20][13:40:26.287][INFO] peel up (speed) params: [1500, 2000, 2500, 3000, 10000], (distance)params: [3000, 4000, 10000, 20000, 30000] #根据截面面积采用的工艺包段数，但这并不是当前图片的截面占比对应的工艺包参数，而是提前预处理之后层对应的工艺包参数
[2022-01-20][13:40:26.291][INFO] peel down (speed) params: [10000, 5000, 2000, 1000, 1000], (distance)params: [-20000, -24000, -25000, -29900, -29900]
[2022-01-20][13:40:26.351][TRACE] Slave State change:  "ES-0 OPR-0 OPL-0 NP-0 ZT-0 ZB-0 ZS-0 ZR-0 ZZ-1 ZP-1 CAU-0 CAL-0 CGU-0 CGD-0 TL-1 CAE-0 ZAE-0 SP-1 TS-0 SP2-0 ST-0 PID-0"  | F- "-2.10"  | lts- "1115"  | rts- "2327"  | lbs- "959"  | rbs- "1846"
[2022-01-20][13:40:27.952][INFO] force: 42.7105
[2022-01-20][13:40:28.330][TRACE] Slave Raw Log >>{  "segMove:num 1|f 39|s 12000"  }<<
[2022-01-20][13:40:31.109][TRACE] exe result: "ZAXIS->SEGMENTED_MOTION" "COMMAND_SUCCESS"
[2022-01-20][13:40:31.116][DEBUG] end SyncPeel #结束剥离
```

```c++
[2022-01-20][13:40:26.269][DEBUG] begin SyncPeel  #开始准备剥离，成型平台粘接打印机粘在料盘中
    .....
[2022-01-20][13:40:31.116][DEBUG] end SyncPeel #剥离结束，成型平台粘结打印件，处在最上方
```

从开始准备剥离到成型平台运动到最上方所用时间：`[13:40:26.269] - [13:40:31.116] = 5s`



从力传感器获取实时数据分析

```c++
13:40:25	-2.055
13:40:25	-2.055
13:40:25	-2.01
13:40:25	-2.01
13:40:26	-2.061
13:40:26	-2.061
13:40:26	-2.1
13:40:26	-2.1
13:40:26	24.692 #力值趋势发生突变，开始准备剥离
13:40:27	24.692
13:40:27	32.617
13:40:27	32.617
13:40:27	36.545
13:40:27	36.545
13:40:28	42.71
13:40:28	42.71
13:40:28	39.985
13:40:28	39.985
13:40:28	40.067
13:40:29	40.067 
13:40:29	5.347 #力值增长趋势发生突变，剥离结束
13:40:29	5.347
13:40:29	3.396
13:40:29	3.396
13:40:30	2.613
13:40:30	2.613
13:40:30	2.143
13:40:30	2.143
13:40:30	1.942
13:40:31	1.942
13:40:31	1.64
13:40:31	1.64
13:40:31	1.787
```

从打印件开始剥离到剥离结束所用时间：`13:40:26 - 13:40:29 = 3s`

即从开始剥离到实际剥离只用了3s，而日志中发出的剥离结束信号是按工艺包规定的路线执行后的剥离结束



因此可以计算出实际剥离发生在工艺包中哪段路程：

根据日志数据

```c++
[2022-01-20][13:40:26.287][INFO] peel up (speed) params: [1500, 2000, 2500, 3000, 10000], (distance)params: [3000, 4000, 10000, 20000, 30000]
```

第一段速度：1500um/s， 路程：3000um，耗时2s

第二段速度：2000um/s，路程：4000-3000=1000um，耗时0.5s

第三段速度：2500um/s，路程：10000-4000=6000um，耗时2.4s

第四段速度：3000um/s，路程：20000-10000=10000um，耗时3.33s

第五段速度：10000um/s，路程：30000-20000=10000um，耗时1s

如果完全按照工艺包走，总耗时为：2s + 0.5s + 2.4s + 3.33s + 1s = 9.23s

根据实际剥离时间只用了3s，所以实际剥离发生在第三段速度中

此时成型平台粘结打印机剥离实际走动的位移为：3000um + 1000um + (3s - 2s - 0.5s) * 2500um/s = 5250um，即可完全剥离开

**即对于绷膜料盘，剥离位移大致在5250um即可完全剥离开**



关于快速剥离策略在绷膜料盘打印机上的使用

```
13:40:26	24.692 #力值趋势发生突变，开始准备剥离
13:40:27	24.692
13:40:27	32.617
13:40:27	32.617
13:40:27	36.545
13:40:27	36.545
13:40:28	42.71
13:40:28	42.71
13:40:28	39.985
13:40:28	39.985
13:40:28	40.067
13:40:29	40.067 
13:40:29	5.347 #力值增长趋势发生突变，剥离结束
```

可以发现，在剥离过程中，力值会发生抖动，并不是单调递增，快速剥离策略会导致剥离发生在实际应该发生剥离时间之前，

**工艺包内容**

对于工艺包文件`14_Study Model UV White_100@2.0.0.8@20220117_194410.pp`

```
{
    "Material": "Study Model UV White",
    "Density": 1.0,
    "MaterialCoeffX": 1.0050000,
    "MaterialCoeffY": 1.0050000,

    "Strategy": {
        "Name": "Fast(100um)",
        "Thickness": 100,
        "Offset": 0,
        "LedExposeTime": 7000,
        "LedPower": 15.00,
        "SupportExposeTime": 1000,
        "SupportExposePower": 15.00,
        "FirstExposeTime": 7000,
        "FirstExposePower": 15.00,
        "BaseThickness": 1000,
        "BaseStartExposeTime": 7000,
        "BaseEndExposeTime": 7000,
        "ProfileExposeTime": 100,
        "FillExposeTime": 100,
        "PeelMode": 1,

        "MotorParameters": [{
                "AreaLowerLimit": 0.0,
                "AreaUpperLimit": 7.0,
                "Number": 1,
                "WaitTime": 2000,
                "Z_AxisUp": [
                    { "v": 1500, "s": 2000 },
                    { "v": 2000, "s": 4000 },
                    { "v": 5000, "s": 10000 },
                    { "v": 10000, "s": 30000 },
                    { "v": 10000, "s": 30000 }
                ],
                "Z_AxisDown": [
                    { "v": 10000, "s": -10000 },
                    { "v": 5000, "s": -14000 },
                    { "v": 2000, "s": -15000 },
                    { "v": 1000, "s": -29900 },
                    { "v": 1000, "s": -29900 }
                ]
            },
            {
                "AreaLowerLimit": 7.0,
                "AreaUpperLimit": 25.0,
                "Number": 2,
                "WaitTime": 3000,
                "Z_AxisUp": [
                    { "v": 1500, "s": 3000 },
                    { "v": 2000, "s": 5000 },
                    { "v": 5000, "s": 10000 },
                    { "v": 10000, "s": 30000 },
                    { "v": 10000, "s": 30000 }
                ],
                "Z_AxisDown": [
                    { "v": 10000, "s": -10000 },
                    { "v": 5000, "s": -14000 },
                    { "v": 2000, "s": -15000 },
                    { "v": 1000, "s": -29900 },
                    { "v": 1000, "s": -29900 }
                ]
            },
            {
                "AreaLowerLimit": 25.0,
                "AreaUpperLimit": 98.0,
                "Number": 3,
                "WaitTime": 4000,
                "Z_AxisUp": [
                    { "v": 1500, "s": 3000 },
                    { "v": 2000, "s": 5000 },
                    { "v": 5000, "s": 10000 },
                    { "v": 10000, "s": 30000 },
                    { "v": 10000, "s": 30000 }
                ],
                "Z_AxisDown": [
                    { "v": 10000, "s": -10000 },
                    { "v": 5000, "s": -14000 },
                    { "v": 2000, "s": -15000 },
                    { "v": 1000, "s": -29900 },
                    { "v": 1000, "s": -29900 }
                ]
            },
            {
                "AreaLowerLimit": 98.0,
                "AreaUpperLimit": 100.0,
                "Number": 4,
                "WaitTime": 5000,
                "Z_AxisUp": [
                    { "v": 1500, "s": 3000 },
                    { "v": 2000, "s": 5000 },
                    { "v": 5000, "s": 10000 },
                    { "v": 10000, "s": 30000 },
                    { "v": 10000, "s": 30000 }
                ],
                "Z_AxisDown": [
                    { "v": 10000, "s": -10000 },
                    { "v": 5000, "s": -14000 },
                    { "v": 2000, "s": -15000 },
                    { "v": 1000, "s": -29900 },
                    { "v": 1000, "s": -29900 }
                ]
            }
        ]
    }
}
```
